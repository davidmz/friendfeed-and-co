<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script type="text/javascript">
function handleMessage(message) {
    if (message.name === "getSettings") {
	var names = ["fixNames", "replyLinks", "openImages", "lightBoxedImages", "killDuck", "withAvatars", "highlightRefComments", "highlightAuthorComments", "withAvatars"];
	var settings = {};
	names.forEach(function(name) {settings[name] = safari.extension.settings.getItem(name);});
	message.target.page.dispatchMessage("SettingsReady", settings);
    }
}
safari.application.addEventListener("message", handleMessage, false);
    </script>
</head>
<body />
</html>
