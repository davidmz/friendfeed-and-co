/**
 * FriendFeed & Co (Stand Alone Complex)
 * @version 1.45
 * @copyright 2014, 2015 David Mzareulyan
 * @link https://github.com/davidmz/friendfeed-and-co
 * @license MIT
 */
!function(){doIt=function(){function e(e){return Array.prototype.slice.call(e)}function t(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function n(e,t){var n=document.createElement(e);if("object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i]);if(arguments.length>2)for(var o=2;o<arguments.length;o++){var a=arguments[o];a instanceof Node?n.appendChild(a):"string"==typeof a&&n.appendChild(document.createTextNode(a))}return n}function i(e,t,n){n=n||!1;var o=n?e:e.parentNode;return o&&o.nodeType==Node.ELEMENT_NODE?o.matches(t)?o:i(o,t):null}function o(t,n){return e(t.querySelectorAll(n))}function a(e){v.push(e)}var r,s,c="1.45",l="//cdn.rawgit.com/davidmz/friendfeed-and-co/v"+c,d="undefined"!=typeof chrome&&"undefined"!=typeof chrome.extension,u=function(e){var t=["fixNames","replyLinks","openImages","lightBoxedImages","killDuck","withAvatars","highlightRefComments","highlightAuthorComments","newLines","markLinks"];e=e||{};var n={};return t.forEach(function(t){n[t]=t in e?e[t]:"withAvatars"!==t}),n},h=new Promise(function(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,0):document.addEventListener("DOMContentLoaded",e)}),m={init:function(){},loadSettings:function(){return new Promise(function(e){var t;chrome.storage.sync.get("settings",function(n){t=n&&"settings"in n?u(n.settings):u(),e(t)})})},saveSettings:function(e){return new Promise(function(t){chrome.storage.sync.set({settings:e},t)})}},f={init:function(){var e=this;window.addEventListener("message",function(t){if("action"in t.data&&"getSettings"===t.data.action&&e.loadSettings().then(function(e){t.source.postMessage(e,t.origin)}),"action"in t.data&&"saveSettings"===t.data.action&&e.saveSettings(t.data.value),"action"in t.data&&"checkUpdates"===t.data.action){var n=Date.now();localStorage["ffc-sac-next-update"]=n+36e5;var i=new XMLHttpRequest;i.open("GET","https://rawgit.com/davidmz/friendfeed-and-co/master/manifest.json"),i.onload=function(){try{var e=JSON.parse(this.response);"version"in e&&(localStorage["ffc-sac-version"]=e.version,localStorage["ffc-sac-next-update"]=n+864e5,alert(e.version!=c?"Доступна новая версия: "+e.version+". Она будет установлена после перезагрузки страницы.":"У вас установлена последняя версия"))}catch(t){}},i.send()}})},loadSettings:function(){return new Promise(function(e){var t;try{t=u(JSON.parse(localStorage["ffc-sac-settings"]))}catch(n){t=u()}e(t)})},saveSettings:function(e){return localStorage["ffc-sac-settings"]=JSON.stringify(e),new Promise(function(e){setTimeout(e,0)})}},p={init:function(){var e=this;this.loadResolver=null,this.parentOrigin=location.protocol+"//friendfeed.com",window.addEventListener("message",function(t){t.origin===e.parentOrigin&&null!==e.loadResolver&&(e.loadResolver(u(t.data)),e.loadResolver=null)})},loadSettings:function(){var e=this;return new Promise(function(t){e.loadResolver=t,window.parent.postMessage({action:"getSettings",value:null},e.parentOrigin)})},saveSettings:function(e){var t=this;return new Promise(function(n){window.parent.postMessage({action:"saveSettings",value:e},t.parentOrigin),setTimeout(n,0)})}},g={init:function(){},loadSettings:function(){return new Promise(function(e){setTimeout(function(){e(u())},0)})},saveSettings:function(){return new Promise(function(e){setTimeout(e,0)})}},v=[],y=new MutationObserver(function(t){t.forEach(function(t){0!=t.addedNodes.length&&e(t.addedNodes).forEach(function(e){e.nodeType==Node.ELEMENT_NODE&&v.forEach(function(t){t(e)})})})});d?s=m:"friendfeed.com"===location.hostname?(s=f,h.then(function(){var e=l+"/content.css",t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.head.appendChild(t)})):s=window.parent?p:g,!d&&"ffc-sac-version"in localStorage&&(c=localStorage["ffc-sac-version"]),h.then(function(){s.init(),s.loadSettings().then(function(e){r=e,v.forEach(function(e){e()}),y.observe(document.body,{childList:!0,subtree:!0})})}),a(function(e){if(void 0===e){var t=document.createElement("DIV");t.className="box",t.innerHTML='<div class="box-bar ffnco">\n    <div class="box-corner"></div>\n    <div class="box-bar-text">&nbsp;</div>\n</div>\n<div class="box-body">\n    <ul>\n        <li>\n            <a href="#">Настройки FF&amp;Co</a>\n            <div class="updated">v {{VERSION}}</div>\n        </li>\n    </ul>\n</div>\n<div class="box-bottom">\n    <div class="box-corner"></div>\n    <div class="box-spacer"></div>\n</div>\n        '.replace("{{VERSION}}",c),t.querySelector("a").onclick=function(e){if(e.preventDefault(),d)window.open(chrome.extension.getURL("options.html"));else{var t=l+"/options.html",n='<!--suppress HtmlUnknownTarget --><div class="light-box-shadow"><div class="light-box-container"><iframe src="{{URL}}" class="light-box-iframe" frameborder="0"></iframe></div></div>',i=document.querySelector(".frf-co-light-box");i.innerHTML=n.replace("{{URL}}",t)}};var n=document.getElementById("sidebar");n&&n.appendChild(t)}}),a(function(t){r.fixNames&&(t=t||document.body,e(t.querySelectorAll(".content > .l_profile, .lbody > .l_profile, .name > .l_profile, .foaf > .l_profile")).forEach(function(e){var t=e.getAttribute("href").substr(1);e.innerHTML!=t&&(e.dataset.displayName=e.innerHTML,e.innerHTML=t)}),e(t.querySelectorAll("#popup .name > .l_profile")).forEach(function(e){var t=e.dataset.displayName;void 0!==t&&(e.innerHTML=e.dataset.displayName)}))}),a(function(e){r.openImages&&(e=e||document.body,o(e,".images.media a[href *= 'm.friendfeed-media.com']").forEach(function(e){var t=/^http:\/\/m\.friendfeed-media\.com\/(.*)/.exec(e.href);t&&(e.dataset.imageSrc=e.href,e.href="http://rss2lj.net/ffimg#"+t[1])}))}),function(){var e=function(){this.image=n("img"),this.cache={},this.queue=[],this.image.addEventListener("load",this.moveQueue.bind(this)),this.image.addEventListener("error",this.moveQueue.bind(this)),this.moveQueue()};e.prototype.add=function(e){e in this.cache||(this.cache[e]=!0,this.queue.push(e))},e.prototype.moveQueue=function(){var e=this.queue.pop();void 0!==e?this.image.src=e:setTimeout(this.moveQueue.bind(this),250)};var t=function(){this.imageStab="/static/images/loading.gif",this.lightBoxImage=n("img",{"class":"light-box-img",src:this.imageStab}),this.lightBox=n("div",{"class":"frf-co-light-box first last hidden"},n("div",{"class":"light-box-shadow"},n("div",{"class":"light-box-container"},this.lightBoxImage),n("div",{"class":"light-box-arrow left"}),n("div",{"class":"light-box-arrow right"}))),this.cList=this.lightBox.classList,this.preloader=new e,this.hidden=!0,this.slides=[],this.index=0,document.body.appendChild(this.lightBox),document.body.addEventListener("keydown",function(e){this.hidden||(27==e.keyCode?this.hide():39==e.keyCode?(this.next(),e.preventDefault()):37==e.keyCode?(this.prev(),e.preventDefault()):36==e.keyCode?(this.first(),e.preventDefault()):35==e.keyCode&&(this.last(),e.preventDefault()))}.bind(this),!0),this.lightBox.addEventListener("click",function(e){var t;null!==(t=i(e.target,".light-box-arrow",!0))?(e.stopPropagation(),t.classList.contains("left")?this.prev():t.classList.contains("right")&&this.next()):i(e.target,".light-box-shadow",!0)&&this.hide()}.bind(this)),this.lightBoxImage.addEventListener("click",function(){window.open(this.slides[this.index].href,"_blank")}.bind(this))};t.prototype.isFirst=function(){return 0===this.index},t.prototype.isLast=function(){return this.index===this.slides.length-1},t.prototype.show=function(e,t){this.slides=e,e.forEach(function(e,n){e===t?this.index=n:this.preloader.add(e.dataset.imageSrc)}.bind(this)),this.hidden=!1,this.cList.remove("hidden"),this._showCurrent()},t.prototype._showCurrent=function(){this.lightBoxImage.src=this.imageStab,this.lightBoxImage.src=this.slides[this.index].dataset.imageSrc,this.isFirst()?this.cList.add("first"):this.cList.remove("first"),this.isLast()?this.cList.add("last"):this.cList.remove("last")},t.prototype.hide=function(){this.hidden||(this.hidden=!0,this.cList.add("hidden"))},t.prototype.next=function(){this.hidden||this.isLast()||(this.index++,this._showCurrent())},t.prototype.prev=function(){this.hidden||this.isFirst()||(this.index--,this._showCurrent())},t.prototype.first=function(){this.hidden||this.isFirst()||(this.index=0,this._showCurrent())},t.prototype.last=function(){this.hidden||this.isLast()||(this.index=this.slides.length-1,this._showCurrent())};var s=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",t+"?url="+encodeURIComponent(e.href)),i.responseType="json",i.onload=function(){n in this.response&&(e.dataset.imageSrc=this.response[n],e.classList.add("light-box-thumbnail"))},i.send()},c=function(e){s(e,"https://noembed.com/embed","media_url")};a(function(e){if(r.lightBoxedImages){if(void 0===e){var n=new t;document.body.addEventListener("click",function(e){if(e.target.matches(".show-more--link"))return e.target.style.display="none",e.target.nextSibling.style.display="inline",void o(e.target.nextSibling,".thumbnail").forEach(function(e){e.src=e.dataset.src});var t=i(e.target,".light-box-thumbnail",!0);if(t&&0==e.button){e.preventDefault();var a=[t],r=i(t,".images.media");r&&(a=o(r,".light-box-thumbnail")),n.show(a,t)}},!1)}e=e||document.body,o(e,".images.media a:not(.light-box-thumbnail)").forEach(function(e){var t=e.querySelector("img"),n="src"in t.dataset?t.dataset.src:t.src;e.dataset.imageSrc?e.classList.add("light-box-thumbnail"):/\.(jpe?g|png|gif)/i.test(e.href)?(e.dataset.imageSrc=e.href,e.classList.add("light-box-thumbnail")):/^http:\/\/m\.friendfeed-media\.com\//.test(e.href)?(e.dataset.imageSrc=e.href,e.classList.add("light-box-thumbnail")):/^https?:\/\/www\.flickr\.com\/photos\//.test(e.href)?/^https?:\/\/farm\d+\.static\.?flickr\.com\//.test(n)?(e.dataset.imageSrc=n.replace(/_.\.jpg$/,"_b.jpg"),e.classList.add("light-box-thumbnail")):c(e):/^https?:\/\/instagram\.com\/p\//.test(e.href)?c(e):/deviantart\.com\/art\//.test(e.href)?s(e,"https://davidmz.me/oembed/deviantart/oembed","url"):/^http:\/\/imgur\.com\//.test(e.href)?(e.dataset.imageSrc="http://i.imgur.com/"+e.href.match(/^http:\/\/imgur\.com\/(gallery\/)?([^#]+)/)[2]+".jpg",e.classList.add("light-box-thumbnail")):/^http:\/\/gyazo\.com\//.test(e.href)?(e.dataset.imageSrc="http://i.gyazo.com/"+e.href.match(/^http:\/\/gyazo\.com\/([^#]+)/)[1]+".png",e.classList.add("light-box-thumbnail")):/soup\.io\/asset/.test(n)&&(e.dataset.imageSrc=n.replace(/_400(\.\w+)$/,"$1"),e.classList.add("light-box-thumbnail"))}),o(e,"a.l_expandmedia:not(.ffco-done)").forEach(function(e){e.classList.add("ffco-done");var t=i(e,".entry"),n=i(e,".media"),a=o(n,".thumbnail").length,r=document.cookie.match(/(?:^| )AT=(.*?)(?:;|$)/)[1],s="entry="+encodeURIComponent(t.getAttribute("eid"))+"&media=1&_nano=1&at="+encodeURIComponent(r),c=new XMLHttpRequest;c.open("POST","/a/expandmedia"),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.responseType="json",c.onload=function(){var e=this.response.html.match(/<a .*?<\/a>/g),t=e.slice(0,a),i=e.slice(a).map(function(e){return e.replace(/src="(.*?)"/,'data-src="$1" src="/static/images/loading.gif"')}),o=document.createElement("div");o.className="images media",o.innerHTML=t.join("")+'<span class="show-more--link"></span><span class="show-more--items">'+i.join("")+"</span>",n.parentNode.insertBefore(o,n),n.parentNode.removeChild(n),n.innerHTML=""},c.send(s)})}})}(),a(function(t){r.killDuck&&void 0===t&&e(document.querySelectorAll('body > div[style*="duck"]')).forEach(function(e){e.style.width=0,e.style.height=0})}),function(){var t=null;a(function(o){if(r.replyLinks){if(void 0===o){var a=document.querySelector(".profile h1 a.name");a&&(t=a.getAttribute("href").substr(1)),document.body.addEventListener("click",n,!1)}if(o=o||document.body,o.classList.contains("comment")&&o.parentNode&&"SPAN"===o.parentNode.tagName){var s=o.parentNode;s.parentNode.insertBefore(o,s),s.parentNode.removeChild(s)}e(o.querySelectorAll(".expandcomment")).forEach(function(e){e.style.counterIncrement="comment "+parseInt(e.querySelector("a").textContent)});for(var c;c=o.querySelector(".comments div.quote");){var l=i(c,".comments"),d=l.parentNode.querySelector(".body > .info > .date").href,u=t,h=l.parentNode.querySelectorAll(".ebody > .title > .name > .l_profile");h.length>0&&(u=h[h.length-1].getAttribute("href").substr(1)),e(l.querySelectorAll("div.quote")).forEach(function(e){var t=e.parentNode,n=t.getAttribute("id"),i=document.createElement("A");i.className=e.className,i.title=e.title,i.href=d+"#"+n;var o=t.querySelector(".l_profile:not(.user-link)"),a=null;o&&(a=o.getAttribute("href").substr(1),t.classList.add("comment-from-"+a)),a===u&&t.classList.add("comment-from-post-author"),t.dataset.author=a?a:"",t.insertBefore(i,e),t.removeChild(e)}),e(l.querySelectorAll(".comment .content")).forEach(function(e){for(var t=e.firstChild;t;){if(t.nodeType==Node.TEXT_NODE&&/\B@([a-z0-9_]+)/.test(t.nodeValue)){for(var n,i=/\B@([a-z0-9_]+)/g,o=t.nodeValue,a=document.createDocumentFragment(),r=0;null!==(n=i.exec(o));){var s=n[0],c=n[1],l=n.index;a.appendChild(document.createTextNode(o.substr(r,l-r))),r=l+s.length;var d=a.appendChild(document.createElement("a"));d.appendChild(document.createTextNode(s)),d.href="/"+c,d.className="l_profile user-link"}var u=a.appendChild(document.createTextNode(o.substr(r)));e.insertBefore(a,t),e.removeChild(t),t=u}t=t.nextSibling}e.normalize()})}}});var n=function(e){if(e.target.matches("a.quote")&&0==e.button){e.preventDefault();var t=null;if(e.metaKey||e.ctrlKey){for(var n=e.target.parentNode,o=1;;)if(n=n.nextElementSibling,n&&n.classList.contains("comment")&&!n.classList.contains("bottomcomment"))o++;else if(n&&n.classList.contains("hiddencomments"));else{if(!n||!n.classList.contains("expandcomment"))break;o+=parseInt(n.querySelector("a").textContent)}t=o>4?"^×"+o:new Array(o+1).join("^")}var a=e.target.parentNode.dataset.author,r=i(e.target,".body"),s=r.querySelector("textarea");if(!s){var c=r.querySelector(".l_comment");c&&(c.click(),s=r.querySelector("textarea"))}s&&(t?(s.value+=t+" ",e.shiftKey&&(s.value+="this")):a&&(s.value+="@"+a+" "),s.focus(),s.selectionStart=s.selectionEnd=s.value.length)}}}(),function(){a(function(a){if(r.replyLinks&&r.withAvatars){if(void 0===a){var s=document.head.appendChild(document.createElement("style"));s.type="text/css",s.title="avatars",t=s.sheet}a=a||document.body,e(a.querySelectorAll(".entry:not(.with-avatars)")).forEach(function(e){e.classList.add("with-avatars")}),e(a.querySelectorAll(".comments > .comment:not(.ffco-with-avatar) .quote")).forEach(function(e){var t=e.parentNode;t.classList.add("ffco-with-avatar");var a=t.dataset.author;!a||a in n||(n[a]=!0,o(a));var r=i(t,".entry:not(.with-avatars)");r&&r.classList.add("with-avatars")})}});var t=null,n={},o=function(e){var n=document.querySelector("a[href='/"+e+"']");if(n){var i=document.querySelector("img[src*='"+n.getAttribute("sid")+"']");if(i){var o=i.src.replace(/-(\w+)-(\d+)$/,"-small-$2");return void t.insertRule(".comment-from-"+e+" > .quote { background-image: url("+o+"); }",0)}}t.insertRule(".comment-from-"+e+" > .quote { background-image: url('//friendfeed-api.com/v2/picture/"+e+"?size=small'); }",0)}}(),function(){a(function(n){r.replyLinks&&r.highlightRefComments&&(n=n||document.body,e(n.querySelectorAll(".l_profile.user-link")).forEach(function(e){c(e,".comment-from-"+e.getAttribute("href").substr(1))}),e(n.querySelectorAll(".comment .content")).forEach(function(e){var n=e.firstChild;if(n&&n.nodeType==Node.TEXT_NODE&&/^\s+[↑^]+/.test(n.nodeValue)){for(var i,o=n.nodeValue;null!==(i=/^(\s+)([↑^]\u00d7(\d+)|[↑^]+)/.exec(o));){var a=void 0===i[3]?i[2].length:parseInt(i[3]),r=t(e.parentNode,a);if(r){e.insertBefore(document.createTextNode(i[1]),n);var s=document.createElement("span");s.className="ups",s.appendChild(document.createTextNode(i[2])),c(s,"#"+r.id),e.insertBefore(s,n)}else e.insertBefore(document.createTextNode(i[0]),n);o=o.substr(i[0].length)}e.insertBefore(document.createTextNode(o),n),e.removeChild(n),e.normalize()}}))});var t=function(e,t){for(var n=null;;)if(e=e.previousElementSibling,e&&e.classList.contains("comment")){if(t--,0==t){n=e;break}}else if(e&&e.classList.contains("hiddencomments"));else{if(!e||!e.classList.contains("expandcomment"))break;if(t-=parseInt(e.querySelector("a").textContent),0>=t)break}return n},n=function(t){var n;(n=t.target.dataset.hlSelector)&&e(i(t.target,".comments").querySelectorAll(".comment")).forEach(function(e){e.matches(n)?e.classList.add("highlighted"):e.classList.remove("highlighted")})},o=function(t){e(i(t.target,".comments").querySelectorAll(".comment.highlighted")).forEach(function(e){e.classList.remove("highlighted")})},s=function(e){location.hash=e.target.dataset.hlSelector},c=function(e,t){e.dataset.hlSelector||(e.dataset.hlSelector=t,e.addEventListener("mouseover",n),e.addEventListener("mouseout",o),"#"==t.charAt(0)&&e.addEventListener("click",s))}}(),a(function(e){r.highlightAuthorComments&&void 0===e&&document.body.classList.add("hl-authors-comments")}),function(){var t="​",n=function(e){var n=null!==i(e,".editentryform, .sharebox");e.value=e.value.replace(/^\n+/,"").replace(/\n+$/,""),n||(e.value=e.value.replace(/\n/g,"\n"+t))};a(function(t){r.newLines&&(void 0===t&&(document.addEventListener("keypress",function(e){13==e.keyCode&&"TEXTAREA"===e.target.nodeName&&e.target.matches(".editentryform textarea, .commentform textarea, .sharebox textarea")&&(e.shiftKey?e.stopPropagation():n(e.target))},!0),document.addEventListener("submit",function(e){var t=e.target.querySelector("textarea[name='body']");t&&t.matches(".editentryform textarea, .commentform textarea, .sharebox textarea")&&n(t)},!0)),t=t||document.body,e(t.querySelectorAll(".comment .content, .entry .text")).forEach(function(e){for(var t=e.firstChild,n=!1,i=e.classList.contains("text"),o=i?/[\n\u2000]/:/\u2000|\u200B/,a=i?/[ \t]*[\u2000\n][ \t]*/:/[ \t]*\u2000|\u200B[ \t]*/;t;){if(t.nodeType==Node.TEXT_NODE&&o.test(t.nodeValue)){n=!0;var r=document.createDocumentFragment(),s=0;t.nodeValue.split(a).forEach(function(e){s=""===e?s+1:0,s>1||(""!==e&&r.appendChild(document.createTextNode(e)),r.appendChild(document.createElement("br")))}),r.removeChild(r.lastChild),e.insertBefore(r,t);var c=t.previousSibling;e.removeChild(t),t=c}t=t.nextSibling}n&&e.normalize()}),e(t.querySelectorAll("textarea")).forEach(function(e){e.value=e.value.replace(/\u200B/g,"").replace(/\u2000/g,"\n")}))})}(),function(){a(function(t){r.markLinks&&(t=t||document.body,e(t.querySelectorAll(".comment .content a, .entry .text a")).forEach(function(e){var t,n=e.previousSibling,i=e.nextSibling;null!==n&&n.nodeType===Node.TEXT_NODE&&"]("===n.nodeValue.slice(-2)&&null!==i&&i.nodeType===Node.TEXT_NODE&&")"===i.nodeValue.slice(0,1)&&null!==(t=/\[(.+?)]\($/.exec(n.nodeValue))&&(e.innerHTML="",e.appendChild(document.createTextNode(t[1])),i.nodeValue=i.nodeValue.slice(1),n.nodeValue=n.nodeValue.slice(0,-t[0].length))}))})}(),function(){a(function(o){o=o||document.body,e(o.querySelectorAll(".container a[href*='akamai.coub.com/get/']")).forEach(function(e){var t=i(e,".images.media");t.parentNode.removeChild(t)}),e(o.querySelectorAll(".entry .ebody")).forEach(function(i){var o=i.querySelectorAll(".media a.l_play");if(o.length>0)e(o).forEach(function(e){var n,i=e.getAttribute("play");if(-1!==i.indexOf("vimeo.com/moogaloop.swf?clip_id="))n=i.match(/moogaloop\.swf\?clip_id=(\d+)/)[1],e.setAttribute("play",'<iframe width="613" height="345" src="//player.vimeo.com/video/'+n+'?autoplay=1" frameborder="0" allowfullscreen></iframe>');else if(-1!==i.indexOf("youtube.com/v/")){n=i.match(/youtube.com\/v\/([^&]+)/)[1],e.setAttribute("play",'<iframe width="613" height="345" src="'+t("//www.youtube.com/v/"+encodeURIComponent(n)+"&autoplay=1&showsearch=0&ap=%2526fmt%3D18&fs=1")+'" frameborder="0" allowfullscreen></iframe>');var o=e.querySelector(".thumbnail");o.style.width="320px",o.style.height="180px",o.src="//img.youtube.com/vi/"+n+"/mqdefault.jpg"}});else{var a,r=0;if(e(i.querySelectorAll(".text a")).forEach(function(e){-1!==e.href.indexOf("//friendfeed.com/")&&"#"===e.firstChild.nodeValue.charAt(0)||-1!==e.href.indexOf("//search.twitter.com/")&&"#"===e.firstChild.nodeValue.charAt(0)||"http://twitter.com/coub"===e.href&&"coub"===e.firstChild.nodeValue||(r++,a=e)}),1===r){var s,c,l;null!==(s=a.href.match(/^https?:\/\/vimeo\.com\/(\d+)/))&&(c=s[1],l=new XMLHttpRequest,l.open("GET","https://vimeo.com/api/v2/video/"+c+".json"),l.responseType="json",l.onload=function(){var e=this.response[0];i.appendChild(n("div",{"class":"images media"},n("div",{"class":"container"},n("a",{rel:"nofollow",href:e.url,"class":"l_play",play:'<iframe width="613" height="345" src="//player.vimeo.com/video/'+c+'?autoplay=1" frameborder="0" allowfullscreen></iframe>'},n("img",{src:e.thumbnail_medium,"class":"thumbnail",style:"width:200px; height:150px",alt:e.title,title:e.title})))))},l.send()),(null!==(s=a.href.match(/^https?:\/\/www\.youtube\.com\/watch.*[?&]v=([^&?#]+)/))||null!==(s=a.href.match(/^https?:\/\/youtu\.be\/([^&?#]+)/)))&&(c=s[1],i.appendChild(n("div",{"class":"images media"},n("div",{"class":"container"},n("a",{rel:"nofollow",href:a.href,"class":"l_play",play:'<iframe width="613" height="345" src="'+t("//www.youtube.com/v/"+encodeURIComponent(c)+"&autoplay=1&showsearch=0&ap=%2526fmt%3D18&fs=1")+'" frameborder="0" allowfullscreen></iframe>'},n("img",{src:"//img.youtube.com/vi/"+c+"/mqdefault.jpg","class":"thumbnail",style:"width:320px; height:180px"})))))),(null!==(s=a.href.match(/^http:\/\/coub\.com\/view\/(\w+)/))||null!==(s=a.title.match(/^http:\/\/coub\.com\/view\/(\w+)/)))&&(c=s[1],l=new XMLHttpRequest,l.open("GET","https://davidmz.me/oembed/coub/oembed.json?url=http://coub.com/view/"+c),l.responseType="json",l.onload=function(){var e=this.response,t=345,o=Math.round(e.width*t/e.height);o>613&&(t=Math.round(613*t/o),o=613),i.appendChild(n("div",{"class":"images media"},n("div",{"class":"container"},n("a",{rel:"nofollow",href:e.url,"class":"l_play",play:'<iframe src="//coub.com/embed/'+c+'?muted=false&autostart=true&originalSize=false&hideTopBar=false&startWithHD=true" allowfullscreen="true" frameborder="0" width="'+o+'" height="'+t+'"></iframe>'},n("img",{src:e.thumbnail_url,"class":"thumbnail",style:"width:auto; height:180px",alt:e.title,title:e.title})))))},l.send())}}})})}()},"complete"===document.readyState||"interactive"===document.readyState?doIt():document.addEventListener("DOMContentLoaded",doIt)}();